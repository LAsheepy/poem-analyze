import{d as F,g as f,G as w,H as R,c,b as l,t as d,a as t,w as r,F as L,n as $,l as P,k as O,r as p,o as n,e as z,I as W,m as V,j as X,J as Y,B as Z,q as U,K as ee,_ as I,h as te,L as se}from"./main-3abf4ed4.js";import{g as B}from"./mockData-70ed22ed.js";const ae={class:"poem-list"},le={class:"list-header"},oe={class:"list-title"},ne={class:"list-actions"},ie={class:"poem-grid"},ce=["onClick"],ue={class:"poem-header"},de={class:"poem-title"},re={class:"poem-meta"},_e={class:"poem-author"},pe={class:"poem-dynasty"},ve={class:"poem-content"},me={key:0,class:"poem-more"},fe={class:"poem-tags"},ge={key:0,class:"tag-more"},he={class:"poem-stats"},ye={class:"stat"},be={class:"stat"},ke={class:"poem-actions"},Ce={key:0,class:"empty-state"},we={key:1,class:"pagination"},Pe=F({__name:"PoemList",props:{poems:{},title:{default:"诗词列表"},showActions:{type:Boolean,default:!0}},setup(x){const v=x,b=O(),o=f(""),i=f(""),g=f(""),h=f(1),k=f(12),C=w(()=>{let a=v.poems;if(o.value){const e=o.value.toLowerCase();a=a.filter(_=>_.title.toLowerCase().includes(e)||_.author.toLowerCase().includes(e)||_.content.some(y=>y.toLowerCase().includes(e))||_.tags.some(y=>y.toLowerCase().includes(e)))}return i.value&&(a=a.filter(e=>e.dynasty===i.value)),g.value&&(a=a.filter(e=>e.difficulty===g.value)),a}),D=w(()=>C.value.length),j=w(()=>Math.ceil(D.value/k.value));w(()=>{const a=(h.value-1)*k.value,e=a+k.value;return C.value.slice(a,e)});const q=a=>({easy:"success",medium:"warning",hard:"danger"})[a]||"info",A=a=>({easy:"简单",medium:"中等",hard:"困难"})[a]||"未知",E=a=>{b.push(`/poems/${a.id}`)},S=a=>{b.push(`/analysis/${a.id}`)},G=a=>{ee.success(`已收藏《${a.title}》`)},H=a=>{h.value=a};return R([o,i,g],()=>{h.value=1}),(a,e)=>{const _=p("el-icon"),y=p("el-input"),u=p("el-option"),M=p("el-select"),N=p("el-tag"),T=p("el-button"),J=p("el-empty"),K=p("el-pagination");return n(),c("div",ae,[l("div",le,[l("h2",oe,d(x.title),1),l("div",ne,[t(y,{modelValue:o.value,"onUpdate:modelValue":e[0]||(e[0]=s=>o.value=s),placeholder:"搜索诗词...",style:{width:"200px"},clearable:""},{prefix:r(()=>[t(_,null,{default:r(()=>[t(z(W))]),_:1})]),_:1},8,["modelValue"]),t(M,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=s=>i.value=s),placeholder:"选择朝代",clearable:""},{default:r(()=>[t(u,{label:"全部",value:""}),t(u,{label:"唐代",value:"唐代"}),t(u,{label:"宋代",value:"宋代"}),t(u,{label:"元代",value:"元代"}),t(u,{label:"明代",value:"明代"}),t(u,{label:"清代",value:"清代"})]),_:1},8,["modelValue"]),t(M,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=s=>g.value=s),placeholder:"选择难度",clearable:""},{default:r(()=>[t(u,{label:"全部",value:""}),t(u,{label:"简单",value:"easy"}),t(u,{label:"中等",value:"medium"}),t(u,{label:"困难",value:"hard"})]),_:1},8,["modelValue"])])]),l("div",ie,[(n(!0),c(L,null,$(C.value,s=>(n(),c("div",{key:s.id,class:"poem-card",onClick:m=>E(s)},[l("div",ue,[l("h3",de,d(s.title),1),t(N,{type:q(s.difficulty),size:"small"},{default:r(()=>[V(d(A(s.difficulty)),1)]),_:2},1032,["type"])]),l("div",re,[l("span",_e,d(s.author),1),l("span",pe,d(s.dynasty),1)]),l("div",ve,[(n(!0),c(L,null,$(s.content.slice(0,2),(m,Q)=>(n(),c("p",{key:Q,class:"poem-line"},d(m),1))),128)),s.content.length>2?(n(),c("p",me,"...")):P("",!0)]),l("div",fe,[(n(!0),c(L,null,$(s.tags.slice(0,3),m=>(n(),X(N,{key:m,size:"small",type:"info"},{default:r(()=>[V(d(m),1)]),_:2},1024))),128)),s.tags.length>3?(n(),c("span",ge," +"+d(s.tags.length-3),1)):P("",!0)]),l("div",he,[l("div",ye,[t(_,null,{default:r(()=>[t(z(Y))]),_:1}),l("span",null,d(s.views||0),1)]),l("div",be,[t(_,null,{default:r(()=>[t(z(Z))]),_:1}),l("span",null,d(s.likes||0),1)])]),l("div",ke,[t(T,{type:"primary",size:"small",onClick:U(m=>S(s),["stop"])},{default:r(()=>[...e[4]||(e[4]=[V(" 开始解析 ",-1)])]),_:1},8,["onClick"]),t(T,{size:"small",onClick:U(m=>G(s),["stop"])},{default:r(()=>[...e[5]||(e[5]=[V(" 收藏 ",-1)])]),_:1},8,["onClick"])])],8,ce))),128))]),C.value.length===0?(n(),c("div",Ce,[t(J,{description:"暂无诗词数据"})])):P("",!0),j.value>1?(n(),c("div",we,[t(K,{"current-page":h.value,"onUpdate:currentPage":e[3]||(e[3]=s=>h.value=s),"page-size":k.value,total:D.value,layout:"prev, pager, next, jumper",onCurrentChange:H},null,8,["current-page","page-size","total"])])):P("",!0)])}}});const Ve=I(Pe,[["__scopeId","data-v-761b2dc4"]]),xe={class:"poems-page"},Le={class:"page-content"},$e=F({__name:"Poems",setup(x){const v=f([]);te(async()=>{await b()});const b=async()=>{try{const{data:o,error:i}=await se.from("poems").select("*").order("created_at",{ascending:!1});i?(console.error("加载诗词数据失败:",i),v.value=B()):o&&o.length>0?v.value=o:v.value=B()}catch(o){console.error("加载诗词数据异常:",o),v.value=B()}};return(o,i)=>(n(),c("div",xe,[i[0]||(i[0]=l("div",{class:"page-header"},[l("h1",{class:"page-title"},"诗词库"),l("p",{class:"page-subtitle"},"探索经典诗词，感受中华文化魅力")],-1)),l("div",Le,[t(Ve,{poems:v.value,title:"全部诗词"},null,8,["poems"])])]))}});const De=I($e,[["__scopeId","data-v-d9d19bf6"]]);export{De as default};
