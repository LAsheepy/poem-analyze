import{f as L,g as c,h as S,d as G,i as J,j as O,c as P,b as e,k as U,w as s,u as Q,r as o,o as b,a as n,l as i,m as W,t as X,e as V,n as Y,p as Z,q as ee,s as te,v as se}from"./main-0f751254.js";import{_ as ne}from"./_plugin-vue_export-helper-c27b6911.js";const ae=L("user",()=>{const l=c(null),_=S(()=>l.value!==null),r=S(()=>{var a;return((a=l.value)==null?void 0:a.role)==="teacher"});return{user:l,isAuthenticated:_,isTeacher:r,setUser:a=>{l.value=a},clearUser:()=>{l.value=null},updateLearningProgress:a=>{l.value&&(l.value.learningProgress=a)}}}),oe=L("ai",()=>{const l=c([]),_=c(!1),r=c(void 0),v=S(()=>l.value.find(a=>a.id===r.value));return{conversations:l,isLoading:_,currentConversationId:r,currentConversation:v,sendMessage:async(a,p)=>{_.value=!0;try{const f={id:Date.now().toString(),content:`这是AI对"${a}"的响应。诗词解析功能将在后续集成。`,timestamp:new Date,poemId:p||null};if(r.value){const u=l.value.find(g=>g.id===r.value);u&&u.messages.push({id:Date.now().toString(),role:"user",content:a,timestamp:new Date},{id:(Date.now()+1).toString(),role:"assistant",content:f.content,timestamp:new Date})}return f}catch{throw new Error("AI服务暂时不可用")}finally{_.value=!1}},createConversation:a=>{const p={id:Date.now().toString(),poemId:a||null,messages:[],createdAt:new Date};return l.value.push(p),r.value=p.id,p.id}}}),le={class:"dashboard"},re={key:0,class:"loading-container"},de={class:"header-content"},ue={class:"user-info"},ie={class:"username"},ce={class:"card-header"},_e={class:"card-header"},pe={class:"ai-content"},me=G({__name:"Dashboard",setup(l){const _=Q(),r=ae(),v=oe(),w=Z,D=ee,a=te,p=se,f=c("dashboard"),u=c(""),g=c(!0),B=c([{id:"1",title:"静夜思",author:"李白",dynasty:"唐代"},{id:"2",title:"春晓",author:"孟浩然",dynasty:"唐代"},{id:"3",title:"登鹳雀楼",author:"王之涣",dynasty:"唐代"}]),N=d=>{_.push(`/${d}`)},T=()=>{v.createConversation()},x=async()=>{if(u.value.trim())try{await v.sendMessage(u.value),u.value=""}catch(d){console.error("发送消息失败:",d)}};return J(async()=>{try{r.setUser({id:"1",username:"测试用户",email:"test@example.com",role:"student",learningProgress:65,interests:["唐诗","宋词"],createdAt:new Date,lastLoginAt:new Date}),await new Promise(d=>setTimeout(d,100)),g.value=!1}catch(d){console.error("Dashboard初始化失败:",d),g.value=!1}}),O(d=>(console.error("Dashboard组件错误:",d),!1)),(d,t)=>{const z=o("el-skeleton"),h=o("el-icon"),I=o("el-menu-item"),E=o("el-menu"),K=o("el-aside"),R=o("el-avatar"),$=o("el-header"),j=o("el-progress"),C=o("el-card"),k=o("el-button"),q=o("el-input"),y=o("el-table-column"),H=o("el-table"),F=o("el-main"),A=o("el-container");return b(),P("div",le,[g.value?(b(),P("div",re,[e(z,{rows:10,animated:""})])):(b(),U(A,{key:1,class:"dashboard-container"},{default:s(()=>[e(K,{width:"250px",class:"sidebar"},{default:s(()=>[t[4]||(t[4]=n("div",{class:"logo"},[n("h2",null,"诗韵星"),n("p",null,"AI驱动诗词解析平台")],-1)),e(E,{"default-active":f.value,class:"sidebar-menu",onSelect:N},{default:s(()=>[e(I,{index:"dashboard"},{default:s(()=>[e(h,null,{default:s(()=>[e(i(w))]),_:1}),t[1]||(t[1]=n("span",null,"工作台",-1))]),_:1}),e(I,{index:"poems"},{default:s(()=>[e(h,null,{default:s(()=>[e(i(D))]),_:1}),t[2]||(t[2]=n("span",null,"诗词解析",-1))]),_:1}),i(r).isTeacher?(b(),U(I,{key:0,index:"teacher"},{default:s(()=>[e(h,null,{default:s(()=>[e(i(a))]),_:1}),t[3]||(t[3]=n("span",null,"教学管理",-1))]),_:1})):W("",!0)]),_:1},8,["default-active"])]),_:1}),e(A,null,{default:s(()=>[e($,{class:"header"},{default:s(()=>{var m,M;return[n("div",de,[t[5]||(t[5]=n("h1",null,"欢迎回来！",-1)),n("div",ue,[e(R,{size:40,src:(m=i(r).user)==null?void 0:m.avatar},null,8,["src"]),n("span",ie,X((M=i(r).user)==null?void 0:M.username),1)])])]}),_:1}),e(F,{class:"main-content"},{default:s(()=>[e(C,{class:"progress-card"},{header:s(()=>{var m;return[n("div",ce,[t[6]||(t[6]=n("span",null,"学习进度",-1)),e(j,{percentage:((m=i(r).user)==null?void 0:m.learningProgress)||0,"stroke-width":8},null,8,["percentage"])])]}),default:s(()=>[t[7]||(t[7]=n("div",{class:"progress-stats"},[n("div",{class:"stat-item"},[n("span",{class:"stat-label"},"已解析诗词"),n("span",{class:"stat-value"},"12")]),n("div",{class:"stat-item"},[n("span",{class:"stat-label"},"平均得分"),n("span",{class:"stat-value"},"85")])],-1))]),_:1}),e(C,{class:"ai-card"},{header:s(()=>[n("div",_e,[t[9]||(t[9]=n("span",null,"AI诗词导师",-1)),e(k,{type:"primary",size:"small",onClick:T},{default:s(()=>[...t[8]||(t[8]=[V(" 开始对话 ",-1)])]),_:1})])]),default:s(()=>[n("div",pe,[t[10]||(t[10]=n("p",null,"您好！我是您的AI诗词导师，可以帮您解析诗词、解答疑问。",-1)),e(q,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=m=>u.value=m),placeholder:"输入您的问题...",onKeyup:Y(x,["enter"])},{append:s(()=>[e(k,{onClick:x},{default:s(()=>[e(h,null,{default:s(()=>[e(i(p))]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1}),e(C,{class:"recommendation-card"},{header:s(()=>[...t[11]||(t[11]=[n("span",null,"推荐诗词",-1)])]),default:s(()=>[e(H,{data:B.value,style:{width:"100%"}},{default:s(()=>[e(y,{prop:"title",label:"诗词标题"}),e(y,{prop:"author",label:"作者"}),e(y,{prop:"dynasty",label:"朝代"}),e(y,{label:"操作"},{default:s(()=>[e(k,{type:"primary",size:"small"},{default:s(()=>[...t[12]||(t[12]=[V("开始解析",-1)])]),_:1})]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1})]),_:1}))])}}});const ge=ne(me,[["__scopeId","data-v-2bcde3f2"]]);export{ge as default};
