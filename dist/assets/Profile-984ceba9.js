import{s as y,_ as os}from"./index-9b4b9506.js";/* empty css               */import{j as ls,r as w,e as is,l as g,t as s,E as a,z as l,F as j,$ as H,ae as ns,k as f,D as c,u,y as rs}from"./vendor-948b6be3.js";import{a1 as o,Q as v,a8 as cs,as as ds,T as _s,av as us,aw as vs,ax as ps,ay as fs,a0 as gs,_ as ms,az as hs,W as ys}from"./element-plus-b9ba9950.js";import{b as m}from"./mockData-3b1561c6.js";import"./supabase-204daf22.js";const ws={class:"profile-page"},ks={class:"profile-content"},bs={class:"profile-layout"},xs={class:"profile-sidebar"},Ds={class:"user-card"},Ss={class:"user-avatar"},Cs={class:"user-info"},Ps={class:"username"},zs={class:"user-email"},Es={class:"stats-card"},Ts={class:"stats-grid"},Is={class:"stat-item"},Bs={class:"stat-value"},Ns={class:"stat-item"},Us={class:"stat-value"},As={class:"stat-item"},Ms={class:"stat-value"},Os={class:"stat-item"},Rs={class:"stat-value"},$s={class:"quick-actions"},Ls={class:"actions-grid"},Vs={class:"profile-main"},qs={class:"section-card"},Fs={class:"progress-stats"},js={class:"progress-item"},Hs={class:"progress-info"},Qs={class:"progress-value"},Ws={class:"progress-item"},Gs={class:"progress-info"},Js={class:"progress-value"},Ks={class:"progress-item"},Xs={class:"progress-info"},Ys={class:"progress-value"},Zs={class:"section-card"},st={class:"activity-list"},tt={class:"activity-icon"},et={class:"activity-content"},at={class:"activity-title"},ot={class:"activity-time"},lt={class:"section-card"},it={class:"interest-tags"},nt={class:"section-card"},rt={class:"account-info"},ct={class:"info-item"},dt={class:"info-value"},_t={class:"info-item"},ut={class:"info-value"},vt={class:"info-item"},pt={class:"info-value"},ft=ls({__name:"Profile",setup(gt){const k=ns(),n=w(null),i=w(null),b=w([]);is(async()=>{await Q(),await W(),await G()});const Q=async()=>{try{const{data:{user:e}}=await y.auth.getUser();if(e){const{data:t,error:d}=await y.from("profiles").select("*").eq("id",e.id).single();d?(console.error("加载用户资料失败:",d),n.value=m()):n.value={...e,...t}}else k.push("/login")}catch(e){console.error("加载用户资料异常:",e),n.value=m()}},W=async()=>{try{i.value=m()}catch(e){console.error("加载用户统计异常:",e),i.value=m()}},G=async()=>{try{b.value=[{id:"1",title:"解析了《静夜思》",created_at:new Date().toISOString()},{id:"2",title:"完成了唐诗学习任务",created_at:new Date(Date.now()-864e5).toISOString()},{id:"3",title:"收藏了《春晓》",created_at:new Date(Date.now()-1728e5).toISOString()}]}catch(e){console.error("加载活动记录异常:",e)}},J=e=>({student:"success",teacher:"warning",admin:"danger"})[e]||"info",K=e=>({student:"学生",teacher:"教师",admin:"管理员"})[e]||"用户",X=()=>{v.info("编辑资料功能开发中")},Y=()=>{v.info("修改密码功能开发中")},Z=()=>{v.info("查看学习历史功能开发中")},ss=()=>{v.info("编辑兴趣功能开发中")},ts=async()=>{try{const{error:e}=await y.auth.signOut();if(e)throw e;v.success("退出登录成功"),k.push("/login")}catch(e){console.error("退出登录失败:",e),v.error("退出登录失败")}},es=e=>new Date(e).toLocaleString("zh-CN"),x=e=>e?new Date(e).toLocaleDateString("zh-CN"):"未知",as=e=>{if(!e)return"0分钟";const t=Math.floor(e/60),d=e%60;return t>0?`${t}小时${d}分钟`:`${d}分钟`};return(e,t)=>{var S,C,P,z,E,T,I,B,N,U,A,M,O,R,$,L,V,q;const d=cs,D=ds,_=ys,p=_s,h=us;return f(),g("div",ws,[t[21]||(t[21]=s("div",{class:"page-header"},[s("h1",{class:"page-title"},"个人中心")],-1)),s("div",ks,[s("div",bs,[s("div",xs,[s("div",Ds,[s("div",Ss,[a(d,{size:80,src:(S=n.value)==null?void 0:S.avatar_url},{default:l(()=>{var r,F;return[c(o(((F=(r=n.value)==null?void 0:r.username)==null?void 0:F.charAt(0))||"U"),1)]}),_:1},8,["src"])]),s("div",Cs,[s("h2",Ps,o(((C=n.value)==null?void 0:C.username)||"用户"),1),s("p",zs,o((P=n.value)==null?void 0:P.email),1),a(D,{type:J((z=n.value)==null?void 0:z.role),size:"small"},{default:l(()=>{var r;return[c(o(K((r=n.value)==null?void 0:r.role)),1)]}),_:1},8,["type"])])]),s("div",Es,[t[4]||(t[4]=s("h3",{class:"stats-title"},"学习统计",-1)),s("div",Ts,[s("div",Is,[s("div",Bs,o(((E=i.value)==null?void 0:E.analyzed_poems)||0),1),t[0]||(t[0]=s("div",{class:"stat-label"},"已解析诗词",-1))]),s("div",Ns,[s("div",Us,o(((T=i.value)==null?void 0:T.streak_days)||0),1),t[1]||(t[1]=s("div",{class:"stat-label"},"连续学习天数",-1))]),s("div",As,[s("div",Ms,o(((I=i.value)==null?void 0:I.average_score)||0)+"%",1),t[2]||(t[2]=s("div",{class:"stat-label"},"平均得分",-1))]),s("div",Os,[s("div",Rs,o(((B=i.value)==null?void 0:B.mastery_level)||"初级"),1),t[3]||(t[3]=s("div",{class:"stat-label"},"掌握等级",-1))])])]),s("div",$s,[t[9]||(t[9]=s("h3",{class:"actions-title"},"快捷操作",-1)),s("div",Ls,[a(p,{type:"primary",onClick:X},{default:l(()=>[a(_,null,{default:l(()=>[a(u(vs))]),_:1}),t[5]||(t[5]=c(" 编辑资料 ",-1))]),_:1}),a(p,{onClick:Y},{default:l(()=>[a(_,null,{default:l(()=>[a(u(ps))]),_:1}),t[6]||(t[6]=c(" 修改密码 ",-1))]),_:1}),a(p,{onClick:Z},{default:l(()=>[a(_,null,{default:l(()=>[a(u(fs))]),_:1}),t[7]||(t[7]=c(" 学习历史 ",-1))]),_:1}),a(p,{onClick:ts},{default:l(()=>[a(_,null,{default:l(()=>[a(u(gs))]),_:1}),t[8]||(t[8]=c(" 退出登录 ",-1))]),_:1})])])]),s("div",Vs,[s("div",qs,[t[13]||(t[13]=s("h3",{class:"section-title"},"学习进度",-1)),s("div",Fs,[s("div",js,[s("div",Hs,[t[10]||(t[10]=s("span",{class:"progress-label"},"总体进度",-1)),s("span",Qs,o(((N=i.value)==null?void 0:N.learning_progress)||0)+"%",1)]),a(h,{percentage:((U=i.value)==null?void 0:U.learning_progress)||0,"show-text":!1},null,8,["percentage"])]),s("div",Ws,[s("div",Gs,[t[11]||(t[11]=s("span",{class:"progress-label"},"本周活跃度",-1)),s("span",Js,o(((A=i.value)==null?void 0:A.weekly_activity)||0)+"%",1)]),a(h,{percentage:((M=i.value)==null?void 0:M.weekly_activity)||0,"show-text":!1,status:"success"},null,8,["percentage"])]),s("div",Ks,[s("div",Xs,[t[12]||(t[12]=s("span",{class:"progress-label"},"完成率",-1)),s("span",Ys,o(((O=i.value)==null?void 0:O.completion_rate)||0)+"%",1)]),a(h,{percentage:((R=i.value)==null?void 0:R.completion_rate)||0,"show-text":!1,status:"warning"},null,8,["percentage"])])])]),s("div",Zs,[t[14]||(t[14]=s("h3",{class:"section-title"},"最近活动",-1)),s("div",st,[(f(!0),g(j,null,H(b.value,r=>(f(),g("div",{key:r.id,class:"activity-item"},[s("div",tt,[a(_,null,{default:l(()=>[a(u(ms))]),_:1})]),s("div",et,[s("div",at,o(r.title),1),s("div",ot,o(es(r.created_at)),1)])]))),128))])]),s("div",lt,[t[16]||(t[16]=s("h3",{class:"section-title"},"兴趣标签",-1)),s("div",it,[(f(!0),g(j,null,H((($=n.value)==null?void 0:$.interests)||[],r=>(f(),rs(D,{key:r,type:"info",size:"large",class:"interest-tag"},{default:l(()=>[c(o(r),1)]),_:2},1024))),128)),a(p,{text:"",onClick:ss,class:"add-interest"},{default:l(()=>[a(_,null,{default:l(()=>[a(u(hs))]),_:1}),t[15]||(t[15]=c(" 添加兴趣 ",-1))]),_:1})])]),s("div",nt,[t[20]||(t[20]=s("h3",{class:"section-title"},"账户信息",-1)),s("div",rt,[s("div",ct,[t[17]||(t[17]=s("span",{class:"info-label"},"注册时间：",-1)),s("span",dt,o(x((L=n.value)==null?void 0:L.created_at)),1)]),s("div",_t,[t[18]||(t[18]=s("span",{class:"info-label"},"最后登录：",-1)),s("span",ut,o(x((V=n.value)==null?void 0:V.last_login_at)),1)]),s("div",vt,[t[19]||(t[19]=s("span",{class:"info-label"},"学习时长：",-1)),s("span",pt,o(as((q=i.value)==null?void 0:q.weekly_study_time)),1)])])])])])])])}}});const xt=os(ft,[["__scopeId","data-v-e3a81f47"]]);export{xt as default};
