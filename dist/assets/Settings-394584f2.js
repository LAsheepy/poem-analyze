import{u as A,s as I,_ as Q}from"./index-9b4b9506.js";/* empty css                     *//* empty css               *//* empty css                  *//* empty css                */import{Q as p,aA as W,P as H,$ as K,ax as L,af as X,aB as Y,W as Z,al as h,ad as ee,ae as le,aC as te,R as ae,S as se,T as oe,U as ne,aD as ue,aE as re,ar as de,an as ie,aF as me,aG as pe}from"./element-plus-b9ba9950.js";import{j as fe,r as w,e as ve,l as we,t as s,E as l,z as t,k as y,u as k,y as P,D as d,C as S}from"./vendor-948b6be3.js";import"./supabase-204daf22.js";const _e={class:"settings-page"},ge={class:"settings-content"},Ve={class:"security-settings"},ye={class:"security-item"},ce={class:"security-item"},be={class:"preference-settings"},Ce={class:"notification-settings"},Ee=fe({__name:"Settings",setup(ke){const U=A(),i=w("profile"),g=w(!1),F=w(!1),u=w({username:"",email:"",bio:""}),r=w({currentPassword:"",newPassword:"",confirmPassword:""}),f=w({theme:"light",language:"zh-CN",fontSize:14}),m=w({studyReminders:!0,newFeatures:!0,systemMessages:!0,emailNotifications:!1});ve(async()=>{await $()});const $=async()=>{try{const o=await U.loadUser();o&&(u.value.username=o.username||"",u.value.email=o.email||"",u.value.bio=o.bio||"")}catch(o){console.error("加载用户数据失败:",o),p.error("加载用户数据失败")}},M=async()=>{var o;try{const{error:e}=await I.from("profiles").update({username:u.value.username,bio:u.value.bio,updated_at:new Date().toISOString()}).eq("id",(o=U.user)==null?void 0:o.id);if(e)throw e;p.success("个人信息已更新"),await U.loadUser()}catch(e){console.error("保存个人信息失败:",e),p.error("保存失败")}},z=async()=>{try{if(r.value.newPassword!==r.value.confirmPassword){p.error("两次输入的密码不一致");return}const{error:o}=await I.auth.updateUser({password:r.value.newPassword});if(o)throw o;p.success("密码修改成功"),g.value=!1,r.value={currentPassword:"",newPassword:"",confirmPassword:""}}catch(o){console.error("修改密码失败:",o),p.error(o.message||"修改密码失败")}},B=()=>{localStorage.setItem("userPreferences",JSON.stringify(f.value)),p.success("偏好设置已保存")},D=()=>{localStorage.setItem("userNotifications",JSON.stringify(m.value)),p.success("通知设置已保存")};return(o,e)=>{const c=Z,b=h,O=ee,V=le,N=te,_=ae,n=se,v=oe,C=ne,x=ue,G=re,R=de,J=ie,T=me,E=pe,j=W,q=H;return y(),we("div",_e,[e[42]||(e[42]=s("div",{class:"page-header"},[s("h1",{class:"page-title"},"设置"),s("p",{class:"page-subtitle"},"管理您的账户和偏好设置")],-1)),s("div",ge,[l(j,{gutter:24},{default:t(()=>[l(N,{span:8},{default:t(()=>[l(V,{class:"settings-menu-card"},{header:t(()=>[...e[21]||(e[21]=[s("span",{class:"card-title"},"设置选项",-1)])]),default:t(()=>[l(O,{"default-active":i.value,class:"settings-menu"},{default:t(()=>[l(b,{index:"profile",onClick:e[0]||(e[0]=a=>i.value="profile")},{default:t(()=>[l(c,null,{default:t(()=>[l(k(K))]),_:1}),e[22]||(e[22]=s("span",null,"个人信息",-1))]),_:1}),l(b,{index:"account",onClick:e[1]||(e[1]=a=>i.value="account")},{default:t(()=>[l(c,null,{default:t(()=>[l(k(L))]),_:1}),e[23]||(e[23]=s("span",null,"账户安全",-1))]),_:1}),l(b,{index:"preferences",onClick:e[2]||(e[2]=a=>i.value="preferences")},{default:t(()=>[l(c,null,{default:t(()=>[l(k(X))]),_:1}),e[24]||(e[24]=s("span",null,"偏好设置",-1))]),_:1}),l(b,{index:"notifications",onClick:e[3]||(e[3]=a=>i.value="notifications")},{default:t(()=>[l(c,null,{default:t(()=>[l(k(Y))]),_:1}),e[25]||(e[25]=s("span",null,"通知设置",-1))]),_:1})]),_:1},8,["default-active"])]),_:1})]),_:1}),l(N,{span:16},{default:t(()=>[i.value==="profile"?(y(),P(V,{key:0,class:"setting-content-card"},{header:t(()=>[...e[26]||(e[26]=[s("span",{class:"card-title"},"个人信息",-1)])]),default:t(()=>[l(C,{model:u.value,"label-width":"100px"},{default:t(()=>[l(n,{label:"用户名"},{default:t(()=>[l(_,{modelValue:u.value.username,"onUpdate:modelValue":e[4]||(e[4]=a=>u.value.username=a),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),l(n,{label:"邮箱"},{default:t(()=>[l(_,{modelValue:u.value.email,"onUpdate:modelValue":e[5]||(e[5]=a=>u.value.email=a),placeholder:"请输入邮箱",disabled:""},null,8,["modelValue"])]),_:1}),l(n,{label:"个人简介"},{default:t(()=>[l(_,{modelValue:u.value.bio,"onUpdate:modelValue":e[6]||(e[6]=a=>u.value.bio=a),type:"textarea",rows:3,placeholder:"请输入个人简介"},null,8,["modelValue"])]),_:1}),l(n,null,{default:t(()=>[l(v,{type:"primary",onClick:M},{default:t(()=>[...e[27]||(e[27]=[d("保存更改",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})):S("",!0),i.value==="account"?(y(),P(V,{key:1,class:"setting-content-card"},{header:t(()=>[...e[28]||(e[28]=[s("span",{class:"card-title"},"账户安全",-1)])]),default:t(()=>[s("div",Ve,[s("div",ye,[e[30]||(e[30]=s("div",{class:"security-info"},[s("h4",null,"修改密码"),s("p",null,"定期修改密码以保护账户安全")],-1)),l(v,{type:"primary",onClick:e[7]||(e[7]=a=>g.value=!0)},{default:t(()=>[...e[29]||(e[29]=[d(" 修改密码 ",-1)])]),_:1})]),s("div",ce,[e[32]||(e[32]=s("div",{class:"security-info"},[s("h4",null,"登录设备"),s("p",null,"管理您的登录设备")],-1)),l(v,{onClick:e[8]||(e[8]=a=>F.value=!0)},{default:t(()=>[...e[31]||(e[31]=[d("查看设备",-1)])]),_:1})])])]),_:1})):S("",!0),i.value==="preferences"?(y(),P(V,{key:2,class:"setting-content-card"},{header:t(()=>[...e[33]||(e[33]=[s("span",{class:"card-title"},"偏好设置",-1)])]),default:t(()=>[s("div",be,[l(C,null,{default:t(()=>[l(n,{label:"主题模式"},{default:t(()=>[l(G,{modelValue:f.value.theme,"onUpdate:modelValue":e[9]||(e[9]=a=>f.value.theme=a)},{default:t(()=>[l(x,{label:"light"},{default:t(()=>[...e[34]||(e[34]=[d("浅色模式",-1)])]),_:1}),l(x,{label:"dark"},{default:t(()=>[...e[35]||(e[35]=[d("深色模式",-1)])]),_:1}),l(x,{label:"auto"},{default:t(()=>[...e[36]||(e[36]=[d("跟随系统",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"语言"},{default:t(()=>[l(J,{modelValue:f.value.language,"onUpdate:modelValue":e[10]||(e[10]=a=>f.value.language=a),placeholder:"选择语言"},{default:t(()=>[l(R,{label:"简体中文",value:"zh-CN"}),l(R,{label:"English",value:"en"})]),_:1},8,["modelValue"])]),_:1}),l(n,{label:"字体大小"},{default:t(()=>[l(T,{modelValue:f.value.fontSize,"onUpdate:modelValue":e[11]||(e[11]=a=>f.value.fontSize=a),min:12,max:18,step:1,"show-stops":""},null,8,["modelValue"])]),_:1}),l(n,null,{default:t(()=>[l(v,{type:"primary",onClick:B},{default:t(()=>[...e[37]||(e[37]=[d("保存设置",-1)])]),_:1})]),_:1})]),_:1})])]),_:1})):S("",!0),i.value==="notifications"?(y(),P(V,{key:3,class:"setting-content-card"},{header:t(()=>[...e[38]||(e[38]=[s("span",{class:"card-title"},"通知设置",-1)])]),default:t(()=>[s("div",Ce,[l(C,null,{default:t(()=>[l(n,{label:"学习提醒"},{default:t(()=>[l(E,{modelValue:m.value.studyReminders,"onUpdate:modelValue":e[12]||(e[12]=a=>m.value.studyReminders=a)},null,8,["modelValue"])]),_:1}),l(n,{label:"新功能通知"},{default:t(()=>[l(E,{modelValue:m.value.newFeatures,"onUpdate:modelValue":e[13]||(e[13]=a=>m.value.newFeatures=a)},null,8,["modelValue"])]),_:1}),l(n,{label:"系统消息"},{default:t(()=>[l(E,{modelValue:m.value.systemMessages,"onUpdate:modelValue":e[14]||(e[14]=a=>m.value.systemMessages=a)},null,8,["modelValue"])]),_:1}),l(n,{label:"邮件通知"},{default:t(()=>[l(E,{modelValue:m.value.emailNotifications,"onUpdate:modelValue":e[15]||(e[15]=a=>m.value.emailNotifications=a)},null,8,["modelValue"])]),_:1}),l(n,null,{default:t(()=>[l(v,{type:"primary",onClick:D},{default:t(()=>[...e[39]||(e[39]=[d("保存设置",-1)])]),_:1})]),_:1})]),_:1})])]),_:1})):S("",!0)]),_:1})]),_:1})]),l(q,{modelValue:g.value,"onUpdate:modelValue":e[20]||(e[20]=a=>g.value=a),title:"修改密码",width:"400px"},{footer:t(()=>[l(v,{onClick:e[19]||(e[19]=a=>g.value=!1)},{default:t(()=>[...e[40]||(e[40]=[d("取消",-1)])]),_:1}),l(v,{type:"primary",onClick:z},{default:t(()=>[...e[41]||(e[41]=[d("确认修改",-1)])]),_:1})]),default:t(()=>[l(C,{model:r.value,"label-width":"80px"},{default:t(()=>[l(n,{label:"当前密码"},{default:t(()=>[l(_,{modelValue:r.value.currentPassword,"onUpdate:modelValue":e[16]||(e[16]=a=>r.value.currentPassword=a),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),l(n,{label:"新密码"},{default:t(()=>[l(_,{modelValue:r.value.newPassword,"onUpdate:modelValue":e[17]||(e[17]=a=>r.value.newPassword=a),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),l(n,{label:"确认密码"},{default:t(()=>[l(_,{modelValue:r.value.confirmPassword,"onUpdate:modelValue":e[18]||(e[18]=a=>r.value.confirmPassword=a),type:"password","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}});const $e=Q(Ee,[["__scopeId","data-v-321b22f8"]]);export{$e as default};
