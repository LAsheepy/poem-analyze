import{_ as Q,s as ee}from"./index-9b4b9506.js";/* empty css                *//* empty css                 */import{j as R,r as y,c as V,b as te,l as n,t,E as e,z as u,C as $,F as S,$ as B,ae as j,k as o,u as L,D as x,y as se,J as F,e as ae}from"./vendor-948b6be3.js";import{a1 as r,R as J,an as le,ao as oe,ag as O,ap as ne,aq as ce,Q as W,W as G,ar as ie,as as ue,T as H,am as K,ae as re,a4 as de}from"./element-plus-b9ba9950.js";/* empty css               *//* empty css                  */import{g as U}from"./mockData-3b1561c6.js";import"./supabase-204daf22.js";const _e={class:"poem-list"},pe={class:"list-header"},ve={class:"list-title"},me={key:0,class:"list-actions"},he={class:"poem-grid"},fe=["onClick"],ye={class:"poem-header"},ge={class:"poem-title"},ke={class:"poem-meta"},Ce={class:"poem-author"},be={class:"poem-dynasty"},we={class:"poem-content"},$e={key:0,class:"poem-more"},Pe={class:"poem-tags"},Ve={key:0,class:"tag-more"},xe={class:"poem-stats"},Le={class:"stat"},Ee={class:"stat"},ze={class:"poem-actions"},Se={key:0,class:"empty-state"},Be={key:1,class:"pagination"},Te=R({__name:"PoemList",props:{poems:{},title:{default:"诗词列表"},showActions:{type:Boolean,default:!0},showSearch:{type:Boolean,default:!0}},setup(E){const _=E,p=j(),v=y(""),d=y(""),g=y(""),k=y(1),C=y(12),w=V(()=>{let a=_.poems;if(_.showSearch){if(v.value){const s=v.value.toLowerCase();a=a.filter(f=>f.title.toLowerCase().includes(s)||f.author.toLowerCase().includes(s)||f.content.some(P=>P.toLowerCase().includes(s))||f.tags.some(P=>P.toLowerCase().includes(s)))}d.value&&(a=a.filter(s=>s.dynasty===d.value)),g.value&&(a=a.filter(s=>s.difficulty===g.value))}return a}),i=V(()=>w.value.length),c=V(()=>Math.ceil(i.value/C.value));V(()=>{const a=(k.value-1)*C.value,s=a+C.value;return w.value.slice(a,s)});const z=a=>({easy:"success",medium:"warning",hard:"danger"})[a]||"info",T=a=>({easy:"简单",medium:"中等",hard:"困难"})[a]||"未知",D=a=>{p.push(`/poems/${a.id}`)},I=a=>{p.push(`/analysis/${a.id}`)},M=a=>{W.success(`已收藏《${a.title}》`)},m=a=>{k.value=a};return te([v,d,g],()=>{k.value=1}),(a,s)=>{const f=G,P=J,h=ie,N=le,q=ue,A=H,X=K,Y=oe;return o(),n("div",_e,[t("div",pe,[t("h2",ve,r(E.title),1),E.showSearch?(o(),n("div",me,[e(P,{modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=l=>v.value=l),placeholder:"搜索诗词...",style:{width:"200px"},clearable:""},{prefix:u(()=>[e(f,null,{default:u(()=>[e(L(O))]),_:1})]),_:1},8,["modelValue"]),e(N,{modelValue:d.value,"onUpdate:modelValue":s[1]||(s[1]=l=>d.value=l),placeholder:"选择朝代",clearable:""},{default:u(()=>[e(h,{label:"全部",value:""}),e(h,{label:"唐代",value:"唐代"}),e(h,{label:"宋代",value:"宋代"}),e(h,{label:"元代",value:"元代"}),e(h,{label:"明代",value:"明代"}),e(h,{label:"清代",value:"清代"})]),_:1},8,["modelValue"]),e(N,{modelValue:g.value,"onUpdate:modelValue":s[2]||(s[2]=l=>g.value=l),placeholder:"选择难度",clearable:""},{default:u(()=>[e(h,{label:"全部",value:""}),e(h,{label:"简单",value:"easy"}),e(h,{label:"中等",value:"medium"}),e(h,{label:"困难",value:"hard"})]),_:1},8,["modelValue"])])):$("",!0)]),t("div",he,[(o(!0),n(S,null,B(w.value,l=>(o(),n("div",{key:l.id,class:"poem-card",onClick:b=>D(l)},[t("div",ye,[t("h3",ge,r(l.title),1),e(q,{type:z(l.difficulty),size:"small"},{default:u(()=>[x(r(T(l.difficulty)),1)]),_:2},1032,["type"])]),t("div",ke,[t("span",Ce,r(l.author),1),t("span",be,r(l.dynasty),1)]),t("div",we,[(o(!0),n(S,null,B(l.content.slice(0,2),(b,Z)=>(o(),n("p",{key:Z,class:"poem-line"},r(b),1))),128)),l.content.length>2?(o(),n("p",$e,"...")):$("",!0)]),t("div",Pe,[(o(!0),n(S,null,B(l.tags.slice(0,3),b=>(o(),se(q,{key:b,size:"small",type:"info"},{default:u(()=>[x(r(b),1)]),_:2},1024))),128)),l.tags.length>3?(o(),n("span",Ve," +"+r(l.tags.length-3),1)):$("",!0)]),t("div",xe,[t("div",Le,[e(f,null,{default:u(()=>[e(L(ne))]),_:1}),t("span",null,r(l.views||0),1)]),t("div",Ee,[e(f,null,{default:u(()=>[e(L(ce))]),_:1}),t("span",null,r(l.likes||0),1)])]),t("div",ze,[e(A,{type:"primary",size:"small",onClick:F(b=>I(l),["stop"])},{default:u(()=>[...s[4]||(s[4]=[x(" 开始解析 ",-1)])]),_:1},8,["onClick"]),e(A,{size:"small",onClick:F(b=>M(l),["stop"])},{default:u(()=>[...s[5]||(s[5]=[x(" 收藏 ",-1)])]),_:1},8,["onClick"])])],8,fe))),128))]),w.value.length===0?(o(),n("div",Se,[e(X,{description:"暂无诗词数据"})])):$("",!0),c.value>1?(o(),n("div",Be,[e(Y,{"current-page":k.value,"onUpdate:currentPage":s[3]||(s[3]=l=>k.value=l),"page-size":C.value,total:i.value,layout:"prev, pager, next, jumper",onCurrentChange:m},null,8,["current-page","page-size","total"])])):$("",!0)])}}});const De=Q(Te,[["__scopeId","data-v-5b3d7b9d"]]),Ie={class:"poems-page"},Me={class:"main-content"},Ue={class:"search-section"},Ne={key:0,class:"search-results"},qe={class:"results-header"},Ae={class:"results-content"},Fe={key:0,class:"result-list"},Qe=["onClick"],Re={class:"result-info"},je={class:"result-title"},Je={class:"result-author"},Oe={class:"result-excerpt"},We={key:1,class:"no-results"},Ge={class:"poems-section"},He=R({__name:"Poems",setup(E){j();const _=y([]),p=y(""),v=y(!1),d=V(()=>{if(!p.value.trim())return _.value;const i=p.value.toLowerCase();return _.value.filter(c=>c.title.toLowerCase().includes(i)||c.author.toLowerCase().includes(i)||c.content.toLowerCase().includes(i)||c.dynasty.toLowerCase().includes(i))});ae(async()=>{await g()});const g=async()=>{try{const{data:i,error:c}=await ee.from("poems").select("*").order("created_at",{ascending:!1});c?(console.error("加载诗词数据失败:",c),_.value=U()):i&&i.length>0?_.value=i:_.value=U()}catch(i){console.error("加载诗词数据异常:",i),_.value=U()}},k=()=>{p.value.trim()?v.value=!0:v.value=!1},C=()=>{p.value="",v.value=!1},w=i=>{W.success("跳转到诗词分析页面")};return(i,c)=>{const z=G,T=J,D=H,I=K,M=re;return o(),n("div",Ie,[c[2]||(c[2]=t("div",{class:"page-header"},[t("div",{class:"header-content"},[t("h1",{class:"page-title"},"诗词库"),t("p",{class:"page-subtitle"},"探索经典诗词，感受中华文化魅力")])],-1)),t("div",Me,[t("div",Ue,[e(T,{modelValue:p.value,"onUpdate:modelValue":c[0]||(c[0]=m=>p.value=m),placeholder:"搜索诗词标题、作者或内容...",size:"large",clearable:"",class:"search-input",onInput:k,onClear:C},{prefix:u(()=>[e(z,null,{default:u(()=>[e(L(O))]),_:1})]),_:1},8,["modelValue"])]),v.value?(o(),n("div",Ne,[e(M,{class:"results-card"},{default:u(()=>[t("div",qe,[t("h3",null,"搜索结果 ("+r(d.value.length)+" 条)",1),e(D,{type:"text",onClick:C},{default:u(()=>[...c[1]||(c[1]=[x("关闭",-1)])]),_:1})]),t("div",Ae,[d.value.length>0?(o(),n("div",Fe,[(o(!0),n(S,null,B(d.value,m=>(o(),n("div",{key:m.id,class:"result-item",onClick:a=>w(m.id)},[e(z,null,{default:u(()=>[e(L(de))]),_:1}),t("div",Re,[t("span",je,r(m.title),1),t("span",Je,r(m.author)+" · "+r(m.dynasty),1),t("span",Oe,r(m.content.substring(0,50))+"...",1)])],8,Qe))),128))])):(o(),n("div",We,[e(I,{description:"未找到相关诗词"})]))])]),_:1})])):$("",!0),t("div",Ge,[e(De,{poems:d.value.length>0?d.value:_.value,title:p.value?`搜索结果 (${d.value.length} 条)`:"全部诗词","show-search":!1},null,8,["poems","title"])])])])}}});const ot=Q(He,[["__scopeId","data-v-4b572adf"]]);export{ot as default};
