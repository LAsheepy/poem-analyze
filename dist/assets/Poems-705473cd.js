import{b as F,J as ee,K as te,B as Q,L as se,M as le,a as R,g as j,N as ae,O as oe,d as J,I as K,z as ne,n as ce}from"./element-plus-abf5d86a.js";import{q as W,r as y,c as V,y as ie,D as n,E as t,U as u,W as e,P as r,S as $,V as S,ak as B,bz as G,C as o,u as L,T as x,O as ue,a2 as O,z as re}from"./vendor-8a15b9c1.js";import{_ as H,s as de}from"./index-11b9615f.js";import{g as U}from"./mockData-3b1561c6.js";import"./supabase-a98c21e8.js";const _e={class:"poem-list"},ve={class:"list-header"},pe={class:"list-title"},me={key:0,class:"list-actions"},he={class:"poem-grid"},fe=["onClick"],ye={class:"poem-header"},ge={class:"poem-title"},ke={class:"poem-meta"},Ce={class:"poem-author"},be={class:"poem-dynasty"},we={class:"poem-content"},$e={key:0,class:"poem-more"},Pe={class:"poem-tags"},Ve={key:0,class:"tag-more"},xe={class:"poem-stats"},Le={class:"stat"},Ee={class:"stat"},ze={class:"poem-actions"},Se={key:0,class:"empty-state"},Be={key:1,class:"pagination"},Ie=W({__name:"PoemList",props:{poems:{},title:{default:"诗词列表"},showActions:{type:Boolean,default:!0},showSearch:{type:Boolean,default:!0}},setup(E){const _=E,v=G(),p=y(""),d=y(""),g=y(""),k=y(1),C=y(12),w=V(()=>{let l=_.poems;if(_.showSearch){if(p.value){const s=p.value.toLowerCase();l=l.filter(f=>f.title.toLowerCase().includes(s)||f.author.toLowerCase().includes(s)||f.content.some(P=>P.toLowerCase().includes(s))||f.tags.some(P=>P.toLowerCase().includes(s)))}d.value&&(l=l.filter(s=>s.dynasty===d.value)),g.value&&(l=l.filter(s=>s.difficulty===g.value))}return l}),i=V(()=>w.value.length),c=V(()=>Math.ceil(i.value/C.value));V(()=>{const l=(k.value-1)*C.value,s=l+C.value;return w.value.slice(l,s)});const z=l=>({easy:"success",medium:"warning",hard:"danger"})[l]||"info",I=l=>({easy:"简单",medium:"中等",hard:"困难"})[l]||"未知",T=l=>{v.push(`/poems/${l.id}`)},D=l=>{v.push(`/analysis/${l.id}`)},M=l=>{R.success(`已收藏《${l.title}》`)},m=l=>{k.value=l};return ie([p,d,g],()=>{k.value=1}),(l,s)=>{const f=j,P=F,h=ae,N=ee,q=oe,A=J,X=K,Y=te;return o(),n("div",_e,[t("div",ve,[t("h2",pe,u(E.title),1),E.showSearch?(o(),n("div",me,[e(P,{modelValue:p.value,"onUpdate:modelValue":s[0]||(s[0]=a=>p.value=a),placeholder:"搜索诗词...",style:{width:"200px"},clearable:""},{prefix:r(()=>[e(f,null,{default:r(()=>[e(L(Q))]),_:1})]),_:1},8,["modelValue"]),e(N,{modelValue:d.value,"onUpdate:modelValue":s[1]||(s[1]=a=>d.value=a),placeholder:"选择朝代",clearable:""},{default:r(()=>[e(h,{label:"全部",value:""}),e(h,{label:"唐代",value:"唐代"}),e(h,{label:"宋代",value:"宋代"}),e(h,{label:"元代",value:"元代"}),e(h,{label:"明代",value:"明代"}),e(h,{label:"清代",value:"清代"})]),_:1},8,["modelValue"]),e(N,{modelValue:g.value,"onUpdate:modelValue":s[2]||(s[2]=a=>g.value=a),placeholder:"选择难度",clearable:""},{default:r(()=>[e(h,{label:"全部",value:""}),e(h,{label:"简单",value:"easy"}),e(h,{label:"中等",value:"medium"}),e(h,{label:"困难",value:"hard"})]),_:1},8,["modelValue"])])):$("",!0)]),t("div",he,[(o(!0),n(S,null,B(w.value,a=>(o(),n("div",{key:a.id,class:"poem-card",onClick:b=>T(a)},[t("div",ye,[t("h3",ge,u(a.title),1),e(q,{type:z(a.difficulty),size:"small"},{default:r(()=>[x(u(I(a.difficulty)),1)]),_:2},1032,["type"])]),t("div",ke,[t("span",Ce,u(a.author),1),t("span",be,u(a.dynasty),1)]),t("div",we,[(o(!0),n(S,null,B(a.content.slice(0,2),(b,Z)=>(o(),n("p",{key:Z,class:"poem-line"},u(b),1))),128)),a.content.length>2?(o(),n("p",$e,"...")):$("",!0)]),t("div",Pe,[(o(!0),n(S,null,B(a.tags.slice(0,3),b=>(o(),ue(q,{key:b,size:"small",type:"info"},{default:r(()=>[x(u(b),1)]),_:2},1024))),128)),a.tags.length>3?(o(),n("span",Ve," +"+u(a.tags.length-3),1)):$("",!0)]),t("div",xe,[t("div",Le,[e(f,null,{default:r(()=>[e(L(se))]),_:1}),t("span",null,u(a.views||0),1)]),t("div",Ee,[e(f,null,{default:r(()=>[e(L(le))]),_:1}),t("span",null,u(a.likes||0),1)])]),t("div",ze,[e(A,{type:"primary",size:"small",onClick:O(b=>D(a),["stop"])},{default:r(()=>[...s[4]||(s[4]=[x(" 开始解析 ",-1)])]),_:1},8,["onClick"]),e(A,{size:"small",onClick:O(b=>M(a),["stop"])},{default:r(()=>[...s[5]||(s[5]=[x(" 收藏 ",-1)])]),_:1},8,["onClick"])])],8,fe))),128))]),w.value.length===0?(o(),n("div",Se,[e(X,{description:"暂无诗词数据"})])):$("",!0),c.value>1?(o(),n("div",Be,[e(Y,{"current-page":k.value,"onUpdate:currentPage":s[3]||(s[3]=a=>k.value=a),"page-size":C.value,total:i.value,layout:"prev, pager, next, jumper",onCurrentChange:m},null,8,["current-page","page-size","total"])])):$("",!0)])}}});const Te=H(Ie,[["__scopeId","data-v-5b3d7b9d"]]),De={class:"poems-page"},Me={class:"main-content"},Ue={class:"search-section"},Ne={key:0,class:"search-results"},qe={class:"results-header"},Ae={class:"results-content"},Oe={key:0,class:"result-list"},Fe=["onClick"],Qe={class:"result-info"},Re={class:"result-title"},je={class:"result-author"},Je={class:"result-excerpt"},Ke={key:1,class:"no-results"},We={class:"poems-section"},Ge=W({__name:"Poems",setup(E){G();const _=y([]),v=y(""),p=y(!1),d=V(()=>{if(!v.value.trim())return _.value;const i=v.value.toLowerCase();return _.value.filter(c=>c.title.toLowerCase().includes(i)||c.author.toLowerCase().includes(i)||c.content.toLowerCase().includes(i)||c.dynasty.toLowerCase().includes(i))});re(async()=>{await g()});const g=async()=>{try{const{data:i,error:c}=await de.from("poems").select("*").order("created_at",{ascending:!1});c?(console.error("加载诗词数据失败:",c),_.value=U()):i&&i.length>0?_.value=i:_.value=U()}catch(i){console.error("加载诗词数据异常:",i),_.value=U()}},k=()=>{v.value.trim()?p.value=!0:p.value=!1},C=()=>{v.value="",p.value=!1},w=i=>{R.success("跳转到诗词分析页面")};return(i,c)=>{const z=j,I=F,T=J,D=K,M=ne;return o(),n("div",De,[c[2]||(c[2]=t("div",{class:"page-header"},[t("div",{class:"header-content"},[t("h1",{class:"page-title"},"诗词库"),t("p",{class:"page-subtitle"},"探索经典诗词，感受中华文化魅力")])],-1)),t("div",Me,[t("div",Ue,[e(I,{modelValue:v.value,"onUpdate:modelValue":c[0]||(c[0]=m=>v.value=m),placeholder:"搜索诗词标题、作者或内容...",size:"large",clearable:"",class:"search-input",onInput:k,onClear:C},{prefix:r(()=>[e(z,null,{default:r(()=>[e(L(Q))]),_:1})]),_:1},8,["modelValue"])]),p.value?(o(),n("div",Ne,[e(M,{class:"results-card"},{default:r(()=>[t("div",qe,[t("h3",null,"搜索结果 ("+u(d.value.length)+" 条)",1),e(T,{type:"text",onClick:C},{default:r(()=>[...c[1]||(c[1]=[x("关闭",-1)])]),_:1})]),t("div",Ae,[d.value.length>0?(o(),n("div",Oe,[(o(!0),n(S,null,B(d.value,m=>(o(),n("div",{key:m.id,class:"result-item",onClick:l=>w(m.id)},[e(z,null,{default:r(()=>[e(L(ce))]),_:1}),t("div",Qe,[t("span",Re,u(m.title),1),t("span",je,u(m.author)+" · "+u(m.dynasty),1),t("span",Je,u(m.content.substring(0,50))+"...",1)])],8,Fe))),128))])):(o(),n("div",Ke,[e(D,{description:"未找到相关诗词"})]))])]),_:1})])):$("",!0),t("div",We,[e(Te,{poems:d.value.length>0?d.value:_.value,title:v.value?`搜索结果 (${d.value.length} 条)`:"全部诗词","show-search":!1},null,8,["poems","title"])])])])}}});const tt=H(Ge,[["__scopeId","data-v-4b572adf"]]);export{tt as default};
